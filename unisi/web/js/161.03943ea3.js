"use strict";(globalThis["webpackChunkuniqua"]=globalThis["webpackChunkuniqua"]||[]).push([[161],{5161:(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var o=s(1758),d=s(8790);const i={ref:"graph",class:"fit",id:"graph"},l={key:0,id:"header"};function r(e,t,s,r,a,n){return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",null,["_"!=s.data.name[0]?((0,o.uX)(),(0,o.CE)("div",l,(0,d.v_)(s.data.name),1)):(0,o.Q3)("",!0)])],512)}s(7225),s(8743),s(2858),s(2071),s(5520),s(2775),s(6203),s(7781),s(4739),s(8499);var a=s(3952),n=s(411);let g="#091159",h={enableEdgeEvents:!0,hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!0,enableEdgeClickEvents:!0,enableEdgeWheelEvents:!1,enableEdgeHoverEvents:!0,enableEdgeHovering:!0,allowInvalidContainer:!0,enableEdgeClickEvents:!0,enableEdgeHoverEvents:!0,defaultNodeColor:"#FCA072",defaultNodeType:"circle",defaultEdgeColor:"#888",defaultEdgeType:"arrow",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#00838F",attribute:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,animationsTime:1e3,borderSize:2,outerBorderSize:3,defaultNodeOuterBorderColor:"rgb(236, 81, 72)",edgeHoverHighlightNodes:"circle",sideMargin:1,edgeHoverColor:"edge",defaultEdgeHoverColor:"#062646",edgeHoverSizeRatio:1,edgeHoverExtremities:!0,scalingMode:"outside",nodeProgramClasses:{image:null}};const u={name:"sgraph",props:{data:{type:Object,required:!0},pdata:{type:Object,required:!0}},data(){return{Dark:n.A,s:null,state:{searchQuery:""},selectedNodes:[],selectedEdges:[],graph:null,fa2start:null,fa2stop:null,fa2run:null,Sigma:null,MultiDirectedGraph:null,FA2Layout:null,forceAtlas2:null,NodeImageProgram:null}},methods:{sendMessage(e,t){(0,a.tN)([this.pdata["name"],this.data["name"],e,t])},refresh(){if(!this.graph)return;let e=this.graph();const t=this.forceAtlas2.inferSettings(e);let s=new this.FA2Layout(e,{settings:t});a.Rl&&console.log("refresh graph",this.data.name,this.pdata.name),s.isRunning()||(s.start(),setTimeout((function(){s.stop()}),1e3))},setSelectedEdges(e){this.s.selectEdges(e)},setSearchQuery(e){if(e){const t=e.toLowerCase(),s=this.graph().nodes().map((e=>({id:e,label:this.graph().getNodeAttribute(e,"label")}))).filter((({label:e})=>e.toLowerCase().includes(t)));if(1===s.length&&s[0].label===e){this.state.selectedNode=s[0].id,this.state.suggestions=void 0;const e=this.s.getNodeDisplayData(this.state.selectedNode);this.s.getCamera().animate(e,{duration:500})}else this.state.selectedNode=void 0,this.state.suggestions=new Set(s.map((({id:e})=>e)))}else this.state.selectedNode=void 0,this.state.suggestions=void 0;this.s.refresh()},load(e){if(!this.graph)return;if(!e)return;let t=e.value||{};this.selectedNodes=t.nodes?t.nodes.map((e=>String(e))):[],this.selectedEdges=t.edges?t.edges.map((e=>String(e))):[];let s=e.sizing,o=Array.isArray(e.nodes)?e.nodes:[],d=Array.isArray(e.edges)?e.edges:[],i=this.graph(),l=[],r=[],a=new Map;for(let e=0;e<o.length;e++){if(!o[e])continue;let t=Object.assign({},o[e]);void 0==t.id&&(t.id=e),void 0!=t.name&&(t.label=t.name);let s={key:String(t.id),attributes:t};t.size=t.size?t.size:10,l.push(s),a.set(t.id,e);let d=i._nodes.get(s.key);d?(t.x=d.attributes.x,t.y=d.attributes.y):(t.x=Math.random(),t.y=Math.random()),this.selectedNodes.includes(s.key)&&(t.highlighted=!0)}let n=[],u=new Map,c=Array(l.length).fill(0);for(let e=0;e<d.length;e++){let t=Object.assign({},d[e]),o=a.get(t.source),i=a.get(t.target);if(void 0==o||void 0==i)continue;if(void 0==t.id&&(t.id=e),t.name&&(t.label=t.name),t.key=String(t.id),r.push(t),s){"in"!=s&&(i=a.get(t.source),o=a.get(t.target)),c[i]++,u.has(i)?u.get(i).push(o):u.set(i,[o]);let e=n.indexOf(o),d=n.indexOf(i);if(-1==e&&(e=n.length,n.push(o)),-1==d&&(d=n.length,n.push(i)),d<e){let t=n[e];n[e]=n[d],n[d]=t}}let l=t.attributes;l||(l={},t.attributes=l),l.id=t.id,l.size=t.size?t.size:5,this.selectedEdges.includes(t.key)?(l.ocolor=l.color?l.color:h.defaultEdgeColor,l.color=g):t.color&&(l.color=t.color),t.label&&(l.label=t.label)}if(s)for(let e=0;e<n.length;e++){let t=n[e];if(u.has(t))for(let e of u.get(t))c[t]+=c[e];l[t].attributes.size=10+c[t]}i.clear(),i.import({nodes:l,edges:r}),this.refresh()}},computed:{value(){if(!this.graph)return{nodes:[],edges:[]};let e=this.graph(),t=this.selectedNodes.map((t=>e._nodes.get(t))).filter(Boolean).map((e=>e.attributes.id)),s=this.selectedEdges.map((t=>e._edges.get(t))).filter(Boolean).map((e=>e.attributes.id));return{nodes:t,edges:s}}},watch:{data:{handler(e,t){a.Rl&&console.log("data update",this.data.name,this.pdata.name),this.load(e)},deep:!0},"Dark.isActive":function(e){this.s&&(this.s.settings.labelColor.color=e?"#00838F":"#000",this.s.refresh())}},updated(){this.s&&(this.s.refresh(),a.Rl&&console.log("updated",this.data.name,this.pdata.name))},mounted(){Promise.all([Promise.all([s.e(121),s.e(324)]).then(s.bind(s,6747)),Promise.all([s.e(121),s.e(324)]).then(s.t.bind(s,8911,23)),Promise.all([s.e(121),s.e(324)]).then(s.t.bind(s,3668,23)),Promise.all([s.e(121),s.e(324)]).then(s.t.bind(s,1944,23)),Promise.all([s.e(121),s.e(324)]).then(s.bind(s,5793))]).then((([e,t,s,o,d])=>{this.Sigma=e.default,this.MultiDirectedGraph=t.default.MultiDirectedGraph,this.MultiDirectedGraph||console.error("Error: MultiDirectedGraph not found in graphologyModule.default"),this.FA2Layout=s.default,this.forceAtlas2=o.default,this.NodeImageProgram=d.NodeImageProgram,h.nodeProgramClasses.image=this.NodeImageProgram;let i=new this.MultiDirectedGraph;this.graph=()=>i;let l=this.$refs.graph;this.s=new this.Sigma(i,l,h);let r=this.s;var u=this;function c(e){e?u.state.hoveredNeighbors=new Set(i.neighbors(e)):(u.state.hoveredNode=void 0,u.state.hoveredNeighbors=void 0),r.refresh()}function f(e,t=g){let s=i.getEdgeAttributes(e);s.color!=t&&(s.ocolor||(s.ocolor=s.color?s.color:h.defaultEdgeColor),i.setEdgeAttribute(e,"color",t))}function p(e,t=g){let s=i.getEdgeAttributes(e);if(s.color==t){let t=i.getEdgeAttribute(e,"ocolor");i.setEdgeAttribute(e,"color",t)}}this.s.settings.labelColor.color=n.A.isActive?"#00838F":"#000",r.on("clickNode",(function(e){let t=e.node;if(!a.Zp.shiftKey){for(let e of u.selectedEdges)p(e);u.selectedEdges=[]}if(u.selectedNodes.includes(t))if(i.setNodeAttribute(t,"highlighted",!1),a.Zp.shiftKey){let e=u.selectedNodes.indexOf(t);-1!=e&&u.selectedNodes.splice(e,1)}else u.selectedNodes=[];else{if(!a.Zp.shiftKey&&u.selectedNodes.length>0){for(let e of u.selectedNodes)i.setNodeAttribute(e,"highlighted",!1);u.selectedNodes=[]}i.setNodeAttribute(t,"highlighted",!0),u.selectedNodes.push(t)}r.refresh(),u.sendMessage("changed",u.value)})),r.on("clickEdge",(function({edge:e}){if(!a.Zp.shiftKey){for(let e of u.selectedNodes)i.setNodeAttribute(e,"highlighted",!1);u.selectedNodes=[]}if(u.selectedEdges.includes(e))if(p(e),a.Zp.shiftKey){let t=u.selectedEdges.indexOf(e);-1!=t&&u.selectedEdges.splice(t,1)}else u.selectedEdges=[];else{if(!a.Zp.shiftKey&&u.selectedEdges.length>0){for(let e of u.selectedEdges)p(e);u.selectedEdges=[]}f(e),u.selectedEdges.push(e)}r.refresh(),u.sendMessage("changed",u.value)})),r.on("enterNode",(function({node:e}){for(let t of i.edgeEntries())t.target==e?f(t.edge,"#808000"):t.source==e&&f(t.edge,"#2F4F4F");c(e)})),r.on("leaveNode",(function({node:e}){for(let t of i.edgeEntries())t.target==e?u.selectedEdges.includes(t.edge)?i.setEdgeAttribute(t.edge,"color",g):p(t.edge,"#808000"):t.source==e&&(u.selectedEdges.includes(t.edge)?i.setEdgeAttribute(t.edge,"color",g):p(t.edge,"#2F4F4F"));c(void 0)})),r.on("enterEdge",(function({edge:e}){u.selectedEdges.includes(e)||f(e)})),r.on("leaveEdge",(function({edge:e}){u.selectedEdges.includes(e)||p(e)}));const b=new ResizeObserver((e=>r.refresh()));b.observe(l);let m=null,E=!1;r.on("downNode",(e=>{E=!0,m=e.node,i.setNodeAttribute(m,"highlighted",!0)})),r.getMouseCaptor().on("mousemovebody",(e=>{if(!E||!m)return;const t=r.viewportToGraph(e);i.setNodeAttribute(m,"x",t.x),i.setNodeAttribute(m,"y",t.y),e.preventSigmaDefault(),e.original.preventDefault(),e.original.stopPropagation()})),r.getMouseCaptor().on("mouseup",(()=>{m&&i.removeNodeAttribute(m,"highlighted"),E=!1,m=null})),r.getMouseCaptor().on("mousedown",(()=>{r.getCustomBBox()||r.setCustomBBox(r.getBBox())})),u.load(u.data)})).catch((e=>{console.error("Error loading sigma.js and related libraries:",e)}))}};var c=s(2807);const f=(0,c.A)(u,[["render",r],["__scopeId","data-v-69aea6da"]]),p=f}}]);